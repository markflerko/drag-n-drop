(this["webpackJsonpdrag-n-drop"]=this["webpackJsonpdrag-n-drop"]||[]).push([[0],{13:function(e,t,n){},15:function(e,t,n){},16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),c=n(8),r=n.n(c),s=n(7),o=n(3),l=n(2),u=(n(13),n(0)),f=function(e){var t=e.figuresData,n=e.canvas;return Object(i.useLayoutEffect)((function(){var e=n.current.getContext("2d");e.clearRect(0,0,n.current.width,n.current.height),function(e){var t=e.figuresData,n=e.context;t.forEach((function(e){n.beginPath(),n.strokeStyle="black",n.lineWidth=1,"square"===e.name?(n.rect(e.x,e.y,e.width,e.height),n.stroke(),n.fillStyle="blue",n.fillRect(e.x,e.y,e.width,e.height)):"circle"===e.name&&(n.fillStyle="green",n.arc(e.x,e.y,e.height/2,0,2*Math.PI),n.fill()),e.selected&&(n.strokeStyle="orangered",n.lineWidth=3),n.stroke()}))}({context:e,figuresData:t})}),[t]),Object(u.jsx)("canvas",{ref:n,className:"canvasContainer",id:"canvas",width:"800",height:"800"})},h=function(e){var t=e.figuresData,n=Object(i.useRef)(null);return Object(u.jsx)("a",{href:"",className:"export",onClick:function(){!function(e){var t=new Blob([e],{type:"application/json"});n.current.href=URL.createObjectURL(t),n.current.download="dogecoin.json"}(JSON.stringify(t))},ref:n,children:"export JSON"})},d=function(e){var t=e.deleteFiguresData,n=e.setFiguresData,a=Object(i.useRef)(null);return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("label",{className:"import__label",htmlFor:"import",children:["import JSON",Object(u.jsx)("input",{type:"file",id:"import",className:"import",ref:a,onChange:function(e){var i;if(t(),null===(i=e.target.files)||void 0===i?void 0:i.length){var a=e.target.files[0],c=new FileReader;c.readAsText(a),c.onload=function(){n(JSON.parse(c.result))}}}})]})})},g=(n(15),function(e){var t=e.top,n=e.left,i=e.figureType;return e.isShow?Object(u.jsx)("div",{className:"".concat(i,"UnderMouse draggable"),style:{top:t,left:n}}):null}),b={height:0,width:0,top:0,left:0,bottom:0,right:0,x:0,y:0},j={shiftX:0,shiftY:0,name:""},v={x:0,y:0,name:"",width:0,height:0,id:0,selected:!1,shiftX:0,shiftY:0},O={top:0,left:0},m=function(e){var t=Object(i.useRef)(null),n=Object(i.useState)(e),a=Object(l.a)(n,2),c=a[0],r=a[1];return Object(i.useLayoutEffect)((function(){r(t.current.getBoundingClientRect())}),[t]),[c,t]},p=function(e){var t=e.figuresData,n=e.event,i=e.canvasCoords,a=n.clientX-i.x,c=n.clientY-i.y;return t.slice().reverse().find((function(e){return function(e){var t=e.element,n=e.x,i=e.y,a=t.name,c=t.x,r=t.y,s=t.width,o=t.height;if("square"===a)return n>=c&&i>=r&&n<=c+s&&i<=r+o;if("circle"===a){var l=o/2;return n>=c-l&&n<=c+l&&i>=r-l&&i<=r+l&&Math.sqrt(Math.pow(n-c,2)+Math.pow(i-r,2))<l}return!1}({element:e,x:a,y:c})}))||null},x=function(e){var t=e.clientX,n=e.clientY,i=e.top,a=e.left,c=e.bottom;return t>e.right||n>c||t<a||n<i};function y(e){var t=e.figures,n=m(b),a=Object(l.a)(n,2),c=a[0],r=a[1],y=m(b),w=Object(l.a)(y,2),C=w[0],S=w[1],X=m(b),Y=Object(l.a)(X,2),D=Y[0],N=Y[1],F=Object(i.useState)(j),M=Object(l.a)(F,2),k=M[0],q=M[1],I=Object(i.useState)(t),R=Object(l.a)(I,2),T=R[0],E=R[1],J=Object(i.useState)(v),L=Object(l.a)(J,2),B=L[0],P=L[1],U=Object(i.useState)(""),A=Object(l.a)(U,2),W=A[0],_=A[1],z=Object(i.useState)(O),G=Object(l.a)(z,2),H=G[0],K=G[1],Q=Object(i.useState)(!1),V=Object(l.a)(Q,2),Z=V[0],$=V[1];Object(i.useEffect)((function(){localStorage.setItem("figures-canvas-position",JSON.stringify(T))}),[T]);var ee=function(){E((function(e){return e.filter((function(e){return!e.selected}))}))},te=function(e){var t=function(e){var t=e.clientX,n=e.clientY,i=e.movableElement,a=e.canvasCoords,c=t-a.x+i.shiftX,r=n-a.y+i.shiftY;if("square"===i.name)c=c<=0?0:c>=a.width-i.width?a.width-i.width:c,r=r<=0?0:r>=a.height-i.height?a.height-i.height:r;else if("circle"===i.name){var s=i.height/2;c=c<=s?s:c>=a.width-s?a.width-s:c,r=r<=s?s:r>=a.height-s?a.height-s:r}return{x:c,y:r}}({clientX:e.clientX,clientY:e.clientY,movableElement:B,canvasCoords:D});E((function(e){return[].concat(Object(s.a)(e.slice(0,-1)),[Object(o.a)(Object(o.a)({},B),t)])}))};return Object(u.jsxs)("div",{className:"App",onMouseUp:function(){"moveInsideCanvas"===W?(_(""),$(!1)):"moveOutsideCanvas"===W&&(_(""),$(!1),ee())},onDragEnd:function(e){var t=e.clientX+k.shiftX,n=e.clientY+k.shiftY,i=k.name,a=T.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{selected:!1})})),c=function(e,t,n){return{x:e,y:t,name:n,width:150,height:100,id:Date.now(),selected:!0,shiftX:0,shiftY:0}}(t,n,i);E([].concat(Object(s.a)(a),[c]))},onDragStart:function(e){var t=e.target.id,n=e.clientX,i=e.clientY,a=function(e){var t=e.name,n=e.squareCoords,i=e.circleCoords,a=e.canvasCoords,c=e.clientX,r=e.clientY,s=0,o=0;return"square"===t?(s=n.x-c-a.x,o=n.y-r-a.y):"circle"===t&&(s=i.x+i.width/2-c-a.x,o=i.y+i.height/2-r-a.y),{shiftX:s,shiftY:o}}({name:t,squareCoords:C,circleCoords:c,canvasCoords:D,clientX:n,clientY:i}),r=a.shiftX,s=a.shiftY;q({shiftX:r,shiftY:s,name:t})},onMouseDown:function(e){var t=p({figuresData:T,event:e,canvasCoords:D});if(t){var n=function(e){var t=e.upperFigure,n=e.figuresData.filter((function(e){return e.id!==t.id})).map((function(e){return Object(o.a)(Object(o.a)({},e),{},{selected:!1})}));return n.push(Object(o.a)(Object(o.a)({},t),{},{selected:!0})),n}({upperFigure:t,figuresData:T});E(n);var i=t.x-(e.clientX-D.x),a=t.y-(e.clientY-D.y);_("moveInsideCanvas"),P(Object(o.a)(Object(o.a)({},t),{},{shiftX:i,shiftY:a,selected:!0}))}},onMouseMove:function(e){var t=e.clientX,n=e.clientY,i=D.top,a=D.bottom,c=D.left,r=D.right;if("moveInsideCanvas"===W)x({clientX:t,clientY:n,top:i,bottom:a,left:c,right:r})&&_("moveOutsideCanvas"),$(!1),te(e);else if("moveOutsideCanvas"===W){x({clientX:t,clientY:n,top:i,bottom:a,left:c,right:r})||_("moveInsideCanvas"),$(!0),te(e);var s=e.clientX+B.shiftX,o=e.clientY+B.shiftY;K({left:s,top:o})}},children:[Object(u.jsx)(g,{top:H.top,left:H.left,figureType:B.name,isShow:Z}),Object(u.jsxs)("div",{className:"grid",children:[Object(u.jsx)("div",{className:"figuresTitle",id:"figuresTitle",children:"figures"}),Object(u.jsx)("div",{className:"canvasTitle",id:"canvasTitle",children:"canvas"}),Object(u.jsxs)("div",{className:"figures",id:"figures",children:[Object(u.jsx)("div",{className:"circle draggable",id:"circle",draggable:"true",ref:r}),Object(u.jsx)("div",{className:"square draggable",id:"square",draggable:"true",ref:S}),Object(u.jsx)("button",{className:"button",onClick:ee,type:"button",children:"delete"}),Object(u.jsx)(h,{figuresData:T}),Object(u.jsx)(d,{deleteFiguresData:function(){return E([])},setFiguresData:E})]}),Object(u.jsx)(f,{figuresData:T,canvas:N})]})]})}n(16);var w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),i(e),a(e),c(e),r(e)}))},C=localStorage.getItem("figures-canvas-position"),S=[];C&&(S=S.concat(JSON.parse(C))),r.a.render(Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(y,{figures:S})}),document.getElementById("root")),w()}},[[17,1,2]]]);
//# sourceMappingURL=main.1d6c492c.chunk.js.map